---
layout: post
title: "[python] Python Logstash integration with Google Cloud Logging"
description: " "
date: 2023-10-23
tags: [python]
comments: true
share: true
---

In this blog post, we will discuss how to integrate Logstash with Google Cloud Logging using Python. Logstash is an open-source tool used for collecting, parsing, and forwarding logs and events. Google Cloud Logging is a managed service that provides a centralized location to store, search, and analyze logs generated by Google Cloud Platform services.

## Table of Contents
- [Prerequisites](#prerequisites)
- [Setting up Logstash](#setting-up-logstash)
- [Creating a Google Cloud Logging Sink](#creating-a-google-cloud-logging-sink)
- [Installing the Python Logging library](#installing-the-python-logging-library)
- [Configuring Logstash](#configuring-logstash)
- [Testing the integration](#testing-the-integration)
- [Conclusion](#conclusion)

## Prerequisites
To follow along with this tutorial, you will need the following:
- Python 3 installed on your system
- Logstash installed and running (version 7.0 or higher)
- A Google Cloud Platform account with access to create a logging sink

## Setting up Logstash
Before we start integrating with Google Cloud Logging, we need to set up Logstash. You can download and install Logstash from the Elastic website. Once installed, configure Logstash to receive logs from your application or system.

## Creating a Google Cloud Logging Sink
To send logs from Logstash to Google Cloud Logging, we need to create a logging sink in Google Cloud Platform. Follow these steps to create a sink:

1. Open the Google Cloud Console
2. Go to the Logs Explorer page
3. Click on "Create Sink"
4. Provide a name for the sink and select the destination log bucket
5. Set the desired filter for the logs to be exported
6. Click on "Create Sink"

Make note of the sink name and log bucket ID, as we will need those in the Logstash configuration.

## Installing the Python Logging library
To send logs from Python to Logstash, we need the Python Logging library. Install it using pip with the following command:

```python
pip install python-logstash
```

## Configuring Logstash
With Logstash and the Python Logging library installed, we can now configure Logstash to forward logs to Google Cloud Logging. Add the following configuration to your Logstash configuration file:

```text
input {
  # Configure your input source here
}

output {
  google_cloud {
    project_id => "your-project-id"
    credentials_file => "path/to/credentials.json"
    logstash_format => true
    logstash_prefix => "logstash"
    logstash_dateformat => "%Y.%m.%d"
  }
}
```

Replace `your-project-id` with your Google Cloud Platform project ID. Set `credentials_file` to the path of the service account credentials JSON file. The `logstash_prefix` and `logstash_dateformat` options can be customized according to your preferences.

## Testing the integration
To test the integration, run your Python application with the following code:

```python
import logging
import logstash

logger = logging.getLogger(__name__)
logger.setLevel(logging.INFO)
logger.addHandler(logstash.LogstashHandler('localhost', 5959))

logger.info("Logstash integration with Google Cloud Logging successful!")
```

Replace `'localhost'` with the IP or hostname of your Logstash server, and `5959` with the port number used by Logstash.

## Conclusion
In this blog post, we explored how to integrate Logstash with Google Cloud Logging using Python. We learned how to set up Logstash, create a logging sink in Google Cloud Platform, install the Python Logging library, and configure Logstash to forward logs to Google Cloud Logging. By following these steps, you can easily centralize and analyze your application logs using Logstash and Google Cloud Logging.